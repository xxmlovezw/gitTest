<!DOCTYPE html>
<html>
<head>
	<title>图书管理员-管理管中心</title>
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
	<link rel="stylesheet" type="text/css" href="../font-awesome/css/font-awesome.min.css">
	<link rel="stylesheet" type="text/css" href="../style/adMain.css">
  <link rel="stylesheet" type="text/css" href="../style/adBook.css">
	<script type="text/javascript" src="../script/jquery-2.1.4.min.js"></script>
   <script type="text/javascript" src="../layer-v2.0/layer/layer.js"></script>
   <script type="text/javascript" src="../layer-v2.0/layer/extend/layer.ext.js">
   </script><script src="https://cdn.staticfile.org/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>

	<script type="text/javascript">
	   $(document).ready(function() {
          $(".left ul li:eq(7)").css("color","#FFF");
          $(".left ul li:eq(7)").css("background-color","#BBCAF1");
          $(".left ul").find('li:eq(7)').children(".trig").css('display', 'block');
          $(".data input").attr('disabled', 'true');
         
          $(".inputBtn").click(function() {
             $(".data input").removeAttr('disabled');
          });

          $(".noadd_btn").click(function() {
            $(".data input").attr('disabled', 'true');
          });

		   var json =  $.cookie('login');
		   console.log(json);
		   var  obj = JSON.parse(json);
		   var userName = obj.userName;
		   var userId = obj.userId;
		   $(".ad_name").text(userName);

		   $(".out").click(function () {
			   $.cookie("login",null);
			   $(location).attr('href','../html/index.html');
		   })

		   $(".add_btn").click(function () {
			   var oldPassword = $(".data_oldPassword").val();
			   var firstPassword = $(".data_firstPassword").val();
			   var  secondPassword = $(".data_secondPassword").val();
			   var  phone = $(".data_phone").val();
			   var  email = $(".data_email").val();
				var body = '&adId='+userId;
			   var state = 0;
			   if (oldPassword == null || oldPassword =='' || typeof oldPassword == "undefined"){
			   		state = 1;
			   		alert("原密码不能为空");
			   } else
			   		body += '&adPassword='+oldPassword;

			   if (firstPassword != null && firstPassword != '' && typeof  firstPassword != "undefined"){
			   		if (firstPassword != secondPassword){
			   			state = 1;
			   			alert("两次密码输入不相同");
					} else {
			   			body += '&password='+firstPassword;
					}
			   }
			   if (phone != null && phone != '' && typeof phone != "undefined")
			   		body += '&adPhone='+phone;
			   if (email != null && email != '' && typeof email != "undefined")
				   body += '&adEmail='+email;

			   console.log(body);

			   fetch("/bookAdmin/alterPassword",{
			   		method:"put",
				   headers:{
			   			'content-type':'application/x-www-form-urlencoded; charset=UTF-8'
				   },
				   body:body
			   }).then(function (response) {
			   		return response.text()
			   }).then(function (value) {
			   		console.log(value);
			   		if ("ok" == value)
			   			alert("信息修改成功");
			   }).catch(function (reason) {

			   })
		   })

	   });
	</script>
</head>
<body>
   <div class="ad_page">
   	<div class="header">
   		<img src="../images/logo.png">
   		<div class="state">
   			<div class="ad_name"><div class="fa_i"><i class="fa fa-user"></i></div><a href="../html/adPersonal.html">管理员01</a></div>
   			<div class="out"><a href="../html/index.html">退出</a></div>
   		</div>
   		<div class="clear"></div>
   	</div>
   	<div class="content">
   		<div class="left">
   			<ul>
   				     <a href="../html/adBorrowBook.html"><li>读者借书<div class="trig"></div></li></a>
               <a href="../html/adReturnBook.html"><li>读者还书<div class="trig"></div></li></a>
               <a href="../html/adAddBook.html"><li>新书入库<div class="trig"></div></li></a>
               <a href="../html/adOutBook.html"><li>图书出库<div class="trig"></div></li></a>
               <a href="../html/adAlterBook.html"><li>修改图书信息<div class="trig"></div></li></a>
               <a href="../html/adCheckBook.html"><li>查阅借阅记录<div class="trig"></div></li></a>
               <a href="../html/adSearchBook.html"><li>查阅图书信息<div class="trig"></div></li></a>
               <a href="../html/adPersonal.html"><li>管理员中心<div class="trig"></div></li></a>
   			</ul>
   		</div>
   		<div class="right">
      <!-- class="ad_data"的div中是图书管理员系统的切换部分 -->
   			<div class="ad_data">
               <input class="inputBtn" style="width:100px;height:34px;margin:0px 0px 20px 150px;font-size:16px"
                type="button" value="修改资料" />
   				     <div class="data data_1"><label style="color:red">原密码必填。不修改密码时，新密码、确认密码留空</label></div>
               <div class="data"><label>原密码</label><input type="password" class="data_oldPassword"/></div>
               <div class="data"><label>新密码</label><input type="password" class="data_firstPassword"/></div>
               <div class="data"><label>确认新密码</label><input type="password"  class="data_secondPassword"/></div>
               <div class="data"><label>电话</label><input value="18823456543" class="data_phone"/></div>
               <div class="data"><label>邮箱</label><input type="email" value="18823456@qq.com" class="data_email"/></div>
               <div class="add_btn">提交修改</div>
                <div class="noadd_btn">取消</div>
   			</div>
   		</div>
   		<div class="clear"></div>
   	</div>
   </div>
</body>
</html>